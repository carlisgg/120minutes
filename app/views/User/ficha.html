#{extends 'main.html' /}
#{set title:'120minutos - Ficha de usuario' /}

<div class="row row-top-bottom-separator">
    <div class="span8 offset2">
        #{form @Application.search()}
            <h4 id="search-title">Que quieres aprender?</h4>
            <input id="search-box" name="terms" type="text" class="input-xxlarge search-query" placeholder="Por ejemplo: HTML5, Calceta, cocina mediterránea...">
            <button type="submit" id="search-button">
                Buscar <i class="icon-search icon-white"></i>
            </button>
        #{/form}
    </div>
</div>

<div class="row">
	<div class="span12 grey-background">
	
		<div class="row">
			<div class="span10 offset1">
				<h3>Tu perfil</h3>
			</div>
		</div>
		
		<div class="row">
			<div class="span2 offset1">
				<img src="@{'/public/images/recurso-foto-ficha.gif'}" class="img-polaroid">
			</div>
			<div class="span8">
				<h4>${user.username}</h4>
				<p>
					${user.descripcion}
				</p>
			</div>
		</div>
		
		<div class="row row-top-bottom-separator">
			<div class="span10 offset1">
				<div class="tabbable"> <!-- Only required for left/right tabs -->
					<ul class="nav nav-tabs">
						<li>
							<a href="#ensenando" data-toggle="tab">Estoy ense&ntilde;ando</a>
						</li>
						<li>
							<a href="#aprendiendo" data-toggle="tab">Estoy aprendiendo</a>
						</li>
						<li>
							<a href="#puedo" data-toggle="tab">Puedo ense&ntilde;ar</a>
						</li>
						<li>
							<a href="#quiero" data-toggle="tab">Quiero aprender</a>
						</li>
					</ul>
					<div class="tab-content profile-tab-content">
						<div class="tab-pane active" id="ensenando">
							<table class="table table-condensed">
								<thead>
									<tr>
										<th>
											<h4 class="position-ico ico-tema">Tema</h4>
										</th>
										<th>
											<h4 class="position-ico ico-autor">Interesado</h4>
										</th>
										<th>
											&nbsp;
										</th>
									</tr>
								</thead>
								<tbody>
									#{list items:user.findEncuentrosOfrecidos(), as:'encuentroComoOfertante'}
									<tr>
										<td>
											<h5>
							        			<a href="/">
							        				${encuentroComoOfertante.tema.titulo}
							        			</a>
							        		</h5>
							        		<p>
							        			${encuentroComoOfertante.tema.descripcion}
							        		</p>
										</td>
										<td>
											<h5>
												<a href="@{User.ficha(encuentroComoOfertante.interesado.id)}#puedo">
							        				${encuentroComoOfertante.interesado.username}
							        			</a>
							        		</h5>
										</td>
										<td>
											#{if (encuentroComoOfertante.estadoExperto == models.Encuentro.Estado.Solicitado)}
												<a href="@{Admin.confirmarEncuentro(encuentroComoOfertante.id)}">
													<i class="icon-ok"></i> Confirmar
												</a>
												<br />
												<a href="@{Admin.rechazarEncuentro(encuentroComoOfertante.id)}">
													<i class="icon-remove"></i> Rechazar
												</a>
											#{/if}
											#{elseif ((encuentroComoOfertante.estadoExperto == models.Encuentro.Estado.Rechazado))}
												<span class="label label-important">Rechazado</span>
											#{/elseif}
											#{elseif ((encuentroComoOfertante.estadoExperto == models.Encuentro.Estado.Cancelado))}
												<span class="label label-important">Cancelado</span>
											#{/elseif}
											#{elseif ((encuentroComoOfertante.estadoExperto == models.Encuentro.Estado.Aceptado))}
												<a href="@{Admin.finalizarEncuentroOfertante(encuentroComoOfertante.id)}">
													<i class="icon-ok"></i> Finalizado
												</a>
											#{/elseif}
											#{elseif ((encuentroComoOfertante.estadoExperto == models.Encuentro.Estado.Finalizado))}
												<h5>
								        			Puntua el encuentro
								        		</h5>
								        		<div>
								        			<ul class="horizontal-list">
								        				<li>
								        					<i class="icon-star"></i>
								        				</li>
								        				<li>
								        					<i class="icon-star"></i>
								        				</li>
								        				<li>
								        					<i class="icon-star"></i>
								        				</li>
								        				<li>
								        					<i class="icon-star"></i>
								        				</li>
								        				<li>
								        					<i class="icon-star icon-white"></i>
								        				</li>
								        			</ul>
								        		</div>
											#{/elseif}
											#{elseif ((encuentroComoOfertante.estadoExperto == models.Encuentro.Estado.Votado))}
								        		<div>
								        			<ul class="horizontal-list">
								        				<li>
								        					<i class="icon-star"></i>
								        				</li>
								        				<li>
								        					<i class="icon-star"></i>
								        				</li>
								        				<li>
								        					<i class="icon-star"></i>
								        				</li>
								        				<li>
								        					<i class="icon-star"></i>
								        				</li>
								        				<li>
								        					<i class="icon-star icon-white"></i>
								        				</li>
								        			</ul>
								        		</div>
											#{/elseif}
										</td>
									</tr>
									#{/list}
								</tbody>
							</table>
						</div>
						<div class="tab-pane active" id="aprendiendo">							
							<table class="table table-condensed">
								<thead>
									<tr>
										<th>
											<h4 class="position-ico ico-tema">Tema</h4>
										</th>
										<th>
											<h4 class="position-ico ico-autor">Usuario</h4>
										</th>
										<th>
											&nbsp;
										</th>
									</tr>
								</thead>
								<tbody>
									#{list items:user.encuentrosSolicitados, as:'encuentroComoSolicitante'}
									<tr>
										<td>
											<h5>
							        			<a href="/">
							        				${encuentroComoSolicitante.tema.titulo}
							        			</a>
							        		</h5>
							        		<p>
							        			${encuentroComoSolicitante.tema.descripcion}
							        		</p>
										</td>
										<td>
											<h5>
												<a href="@{User.ficha(encuentroComoSolicitante.tema.experto.id)}#puedo">
							        				${encuentroComoSolicitante.tema.experto.username}
							        			</a>
							        		</h5>
										</td>
										<td>
											#{if (encuentroComoSolicitante.estadoInteresado == models.Encuentro.Estado.Solicitado)}
											        <span class="label label-info">Esperando confirmacion</span>
											        <br />
											        <a href="@{Admin.cancelarEncuentro(encuentroComoSolicitante.id)}">
											        	<i class="icon-remove"></i> Cancelar
											        </a>
											#{/if}
											#{elseif ((encuentroComoSolicitante.estadoInteresado == models.Encuentro.Estado.Rechazado))}
													<span class="label label-important">Rechazado</span>
											#{/elseif}
											#{elseif ((encuentroComoSolicitante.estadoInteresado == models.Encuentro.Estado.Cancelado))}
													<span class="label label-important">Cancelado</span>
											#{/elseif}
											#{elseif ((encuentroComoSolicitante.estadoInteresado == models.Encuentro.Estado.Aceptado))}
													<a href="@{Admin.finalizarEncuentroSolicitante(encuentroComoSolicitante.id)}">
														<i class="icon-ok"></i> Finalizado
													</a>
											#{/elseif}
											#{elseif ((encuentroComoSolicitante.estadoInteresado == models.Encuentro.Estado.Finalizado))}
													<h5>
									        			Puntua el encuentro
									        		</h5>
									        		<div>
									        			<ul class="horizontal-list">
									        				<li>
									        					<i class="icon-star"></i>
									        				</li>
									        				<li>
									        					<i class="icon-star"></i>
									        				</li>
									        				<li>
									        					<i class="icon-star"></i>
									        				</li>
									        				<li>
									        					<i class="icon-star"></i>
									        				</li>
									        				<li>
									        					<i class="icon-star icon-white"></i>
									        				</li>
									        			</ul>
									        		</div>
											#{/elseif}
											#{elseif ((encuentroComoSolicitante.estadoInteresado == models.Encuentro.Estado.Votado))}
									        		<div>
									        			<ul class="horizontal-list">
									        				<li>
									        					<i class="icon-star"></i>
									        				</li>
									        				<li>
									        					<i class="icon-star"></i>
									        				</li>
									        				<li>
									        					<i class="icon-star"></i>
									        				</li>
									        				<li>
									        					<i class="icon-star"></i>
									        				</li>
									        				<li>
									        					<i class="icon-star icon-white"></i>
									        				</li>
									        			</ul>
									        		</div>
											#{/elseif}
										</td>
									</tr>
									#{/list}
								</tbody>
							</table>
							
						</div>
						<div class="tab-pane" id="puedo">
							<table class="table table-condensed">
								<thead>
									<tr>
										<th>
											<h4 class="position-ico ico-tema">Tema</h4>
										</th>
										<th>
											&nbsp;
										</th>
									</tr>
								</thead>
								<tbody>
									#{list items:user.temas, as:'tema'}
									<tr>
										<td>
											<h5>
							        			<a href="/">
							        				${tema.titulo}
							        			</a>
							        		</h5>
							        		<p>
							        			${tema.descripcion}
							        		</p>
										</td>
										<td>
											<a href="#"><i class="icon-remove"></i> Eliminar</a>
											<br>
											<a href="#"><i class="icon-pencil"></i> Editar</a>
										</td>
									</tr>
									#{/list}
									<tr>
										<td colspan="2">
                                            #{ifErrors}
                                                <p class="error">
                                                ${errors[0]}
                                                </p>
                                            #{/ifErrors}

                                            #{form @User.add_tema()}
                                                <label for="titulo">Dinos lo que puedes enseñar en 120 minutos</label>
                                                <input id="titulo" name="tema.titulo" value="${flash['tema.titulo']}" type="text" size="140" />
                                                <label for="descripcion">Describe un poco más cómo lo vas a hacer</label>
                                                <input id="descripcion" name="tema.descripcion" value="${flash['tema.descripcion']}" type="text" size="140" />

                                                <input type="submit" value="Añadir un tema" />

                                            #{/form}

										</td>
									</tr>
								</tbody>
							</table>
						</div>
						<div class="tab-pane" id="quiero">
							<table class="table table-condensed">
								<thead>
									<tr>
										<th>
											<h4 class="position-ico ico-tema">Tema</h4>
										</th>
										<th>
											&nbsp;
										</th>
									</tr>
								</thead>
								<tbody>
									#{list items:user.intereses, as:'interes'}
									<tr>
										<td>
											<h5>
							        			<a href="/">
							        				${interes.descripcion}
							        			</a>
							        		</h5>
										</td>
										<td>
											<a href="#"><i class="icon-remove"></i> Eliminar</a>
											<br>
											<a href="#"><i class="icon-pencil"></i> Editar</a>
										</td>
									</tr>
									#{/list}
									<tr>
										<td colspan="2">
                                            #{ifErrors}
                                                <p class="error">
                                                ${errors[0]}
                                                </p>
                                            #{/ifErrors}

                                            #{form @User.add_interes()}
                                                <label for="descripcion">Describe lo que te interesa que te cuenten en 120 minutos</label>
                                                <input id="descripcion" name="interes.descripcion" value="${flash['interes.descripcion']}" type="text" size="140" />

                                                <input type="submit" value="Añadir un interés" />

                                            #{/form}
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</div>
		
	</div>
</div>
